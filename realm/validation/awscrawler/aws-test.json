{
    "$schema": "",
    "contentVersion": "1.0.0.0",
    "fileType": "mastertest",
    "notification": [],
    "masterSnapshot": "awssnapshot",
    "testSet": [
        {
            "masterTestName": "test3",
            "version": "0.1",
            "cases": [
                {
                    "masterTestId": "1",
                    "rule": "count({AWS-BUCKETS-01}.Grants[])>=1"
                },
                {
                    "masterTestId": "2",
                    "rule": "contains({AWS-BUCKETS-01}.grants[*].permission)!='FullControl'"
                },
                {
                    "masterTestId": "2",
                    "rule": "{AWS-BUCKETS-01}.Owner.DisplayName='operations'"
                },
                {
                    "masterTestId": "3",
                    "rule": "{AWS-BUCKETS-01}.Grants[0].Permission='FULL_CONTROL'"
                },
                {
                    "masterTestId": "4",
                    "rule": "{AWS-BUCKETS-01}.LocationConstraint='us-west-1'"
                },
                {
                    "masterTestId": "102",
                    "rule": "{AWS-EC2-INSTANCE-01}.Reservations[0].Instances[0].SecurityGroups[0].GroupName='launch-wizard-1'"
                },
                {           
                    "masterTestId": "103",
                    "rule": "{AWS-EC2-INSTANCE-01}.InstanceMonitorings[0].Monitoring.State='enabled'"
                },
                {           
                    "masterTestId": "104",
                    "rule": "{AWS-EC2-IMAGE-01}.Images[0].Public=true"
                },
                {           
                    "masterTestId": "105",
                    "rule": "{AWS-EC2-IMAGE-01}.Images[0].BlockDeviceMappings[0].Ebs.Encrypted=false"
                },
                {           
                    "masterTestId": "106",
                    "rule": "{AWS-EC2-SECGROUP-01}.SecurityGroups['GroupName'='launch-wizard-1'].IpPermissions['FromPort'=80].IpProtocol='tcp'"
                },
                {           
                    "masterTestId": "107",
                    "rule": "{AWS-EC2-INSTANCE-01}.AccountAttributes['AttributeName'='max-instances'].AttributeValues[0].AttributeValue='20'"
                },
                {           
                    "masterTestId": "108",
                    "rule": "{AWS-EC2-INSTANCE-01}.Reservations[0].Instances[0].State.Code!=16"
                },
                {           
                    "masterTestId": "109",
                    "rule": "contains({AWS-EC2-IMAGE-01}.attachments[*].state)='attached'"
                },
                {           
                    "masterTestId": "110",
                    "rule": "contains({AWS-EC2-INSTANCE-01}.attributeValues[*].attributeValue)!='ec2'"
                },
                {           
                    "masterTestId": "201",
                    "rule": "{AWS-EC2-INSTANCE-01}.Subnets[0].MapPublicIpOnLaunch=true"
                },
                {           
                    "masterTestId": "202",
                    "rule": "{AWS-RDS-01}.DBInstances[0].BackupRetentionPeriod<=7"
                },
                {           
                    "masterTestId": "202",
                    "rule": "{AWS-RDS-01}.DBInstances[0].StorageEncrypted=false"
                },
                {           
                    "masterTestId": "202",
                    "rule": "{AWS-RDS-01}.DBInstances[0].CopyTagsToSnapshot=true"
                }
            ]
        }
    ]
}
