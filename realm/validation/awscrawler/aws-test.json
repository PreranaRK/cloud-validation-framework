{
    "$schema": "",
    "contentVersion": "1.0.0.0",
    "fileType": "mastertest",
    "notification": [],
    "masterSnapshot": "awssnapshot",
    "testSet": [
        {
            "masterTestName": "test3",
            "version": "0.1",
            "cases": [
                {
                    "masterTestId": "1",
                    "rule": "count({1}.Grants[])>=1"
                },
                {
                    "masterTestId": "2",
                    "rule": "{1}.Owner.DisplayName='operations'"
                },
                {
                    "masterTestId": "3",
                    "rule": "{1}.Grants[0].Permission='FULL_CONTROL'"
                },
                {
                    "masterTestId": "4",
                    "rule": "{1}.LocationConstraint='us-west-1'"
                },
                {
                    "masterTestId": "102",
                    "rule": "{101}.Reservations[0].Instances[0].SecurityGroups[0].GroupName='launch-wizard-1'"
                },
                {           
                    "masterTestId": "103",
                    "rule": "{101}.InstanceMonitorings[0].Monitoring.State='enabled'"
                },
                {           
                    "masterTestId": "104",
                    "rule": "{103}.Images[0].Public=true"
                },
                {           
                    "masterTestId": "105",
                    "rule": "{103}.Images[0].BlockDeviceMappings[0].Ebs.Encrypted=false"
                },
                {           
                    "masterTestId": "106",
                    "rule": "{102}.SecurityGroups['GroupName'='launch-wizard-1'].IpPermissions['FromPort'=80].IpProtocol='tcp'"
                },
                {           
                    "masterTestId": "107",
                    "rule": "{101}.AccountAttributes['AttributeName'='max-instances'].AttributeValues[0].AttributeValue='20'"
                },
                {           
                    "masterTestId": "108",
                    "rule": "{101}.Reservations[0].Instances[0].State.Code!=16"
                },
                {           
                    "masterTestId": "201",
                    "rule": "{101}.Subnets[0].MapPublicIpOnLaunch=true"
                },
                {           
                    "masterTestId": "202",
                    "rule": "{201}.DBInstances[0].BackupRetentionPeriod<=7"
                },
                {           
                    "masterTestId": "202",
                    "rule": "{201}.DBInstances[0].StorageEncrypted=false"
                },
                {           
                    "masterTestId": "202",
                    "rule": "{201}.DBInstances[0].CopyTagsToSnapshot=true"
                }
            ]
        }
    ]
}
